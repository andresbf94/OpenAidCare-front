<div class="container-fluid">
  <div class="row contenido">
    <div class="col-5">
      <div class="row marginRows rowCards">
        <div class="col-6">
          <div class="card tramosCard">
            <label class="mb-4 titulo"><b>Precio del Kw/h por tramo</b></label>
            <div class="row" >
              <div class="col-6">
                <p class="p1">P1: {{ p1 }} €</p>
                <p class="p2">P2: {{ p2 }} €</p>
                <p class="p3">P3: {{ p3 }} €</p>
              </div>
              <div class="col-6">
                <p class="p4">P4: {{ p4 }} €</p>
                <p class="p5">P5: {{ p5 }} €</p>
                <p class="p6">P6: {{ p6 }} €</p>
              </div>
            </div>
          </div>
        </div>

        <div class="col-6">
            <label></label>
        </div>
        
      </div>

      <div class="row marginRows">
        <label class="labelSeleccion">Seleccionar el numero de bombas</label>
        <div>
          <label for="numBombasPequenas"><b>Pequeñas 2.5kW</b></label>
          <input class="inputBombas" type="number" id="numBombasPequenas" name="numBombasPequenas" [(ngModel)]="numBombasPequenas">
        </div>
        <div style="margin-bottom: 2em;">
          <label  for="numBombasGrandes"><b>Grandes 5kW</b></label>
          <input class="inputBombas" type="number" id="numBombasGrandes" name="numBombasGrandes" [(ngModel)]="numBombasGrandes">
        </div>
      </div>

      <div class="row"> 
        <form #myForm="ngForm" (ngSubmit)="recalcularConsumosCostos()">
          <div class="divHoras">
            <label class="labelSeleccion">Seleccionar las horas a mostrar</label><br>
            <button type="button" class="buttonPrin" (click)="filtrarHorasTramos('todas'); recalcularConsumosCostos(); plegar()"><b>Todas</b></button>
            <button type="button" class="buttonPrin" (click)="filtrarHorasTramos('valle'); recalcularConsumosCostos(); plegar()"><b>Valle</b></button>
            <button type="button" class="buttonPrin" (click)="filtrarHorasTramos('llano'); recalcularConsumosCostos(); plegar()"><b>Llano</b></button>
            <button type="button" class="buttonPrin" (click)="filtrarHorasTramos('punta'); recalcularConsumosCostos(); plegar()"><b>Punta</b></button>
            <button type="button" class="buttonPrin" (click)="desplegar()"><b>Seleccionar</b></button>
          </div>      
          <div *ngIf="desplegado === true">
            <div class="buttons-container">
              <div *ngFor="let hora of obtenerHorasDia()">
                <button
                  type="button"
                  (click)="onButtonChange(hora)"
                  [ngClass]="{ 'selected': isHoraSeleccionada(hora) }"
                >
                  {{ hora }}
                </button>
              </div>
            </div>
          </div>
        </form>
      </div>
 
     
    </div> <!-- cierre col-5 -->
    
    <div class="col-7">
      <div class="row">
        <ng-container *ngIf="consumosCostos.length > 0; else noData">
          <table class="tabla text-center">
            <thead>
              <tr>
                <th>Hora</th>
                <th>Consumo Pequeñas</th>
                <th>Consumo Grandes</th>
                <th>Consumo Total</th>
                <th>Costo Pequeñas</th>
                <th>Costo Grandes</th>
                <th>Costo Total</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let consumo of consumosCostos" [ngClass]="getClasePorTramo(obtenerTramoPorHora(consumo.hora))">
                <td>{{ consumo.hora }}</td> 
                <td>{{ consumo.consumoEstimadoPequenas | number: '1.2-2' }} kW</td>
                <td>{{ consumo.consumoEstimadoGrandes | number: '1.2-2' }} kW</td>
                <td>{{ consumo.consumoEstimadoTotal | number: '1.2-2' }} kW</td>
                <td>{{ consumo.costeEstimadoPequenas | number: '1.2-2' }} €</td>
                <td>{{ consumo.costeEstimadoGrandes | number: '1.2-2' }} €</td>
                <td>{{ consumo.costeEstimadoTotal | number: '1.2-2' }} €</td>
              </tr>
              <!-- Fila de totales -->
              <tr class="totalesRow">
                <th>Total</th>
                <td>{{ consumosCostosTotales[0]?.sumaConsumoEstimadoPequenas | number: '1.2-2'}} kW</td>
                <td>{{ consumosCostosTotales[0]?.sumaConsumoEstimadoGrandes | number: '1.2-2' }} kW</td>
                <td>{{ consumosCostosTotales[0]?.sumaConsumoEstimadoTotal  | number: '1.2-2'  }} kW</td>
                <td>{{ consumosCostosTotales[0]?.sumaCosteEstimadoPequenas  | number: '1.2-2' }} €</td>
                <td>{{ consumosCostosTotales[0]?.sumaCosteEstimadoGrandes  | number: '1.2-2'  }} €</td>
                <td>{{ consumosCostosTotales[0]?.sumaCosteEstimadoTotal  | number: '1.2-2'  }} €</td>
              </tr>
            </tbody>
          </table>
        </ng-container>
        <ng-template #noData>
          <table class="tabla text-center">
            <thead>
              <tr>
                <th>Hora</th>
                <th>Consumo Pequeñas</th>
                <th>Consumo Grandes</th>
                <th>Consumo Total</th>
                <th>Costo Pequeñas</th>
                <th>Costo Grandes</th>
                <th>Costo Total</th>
              </tr>
            </thead>
          </table>
          <div class="text-center mt-5" >
            <img src="../../../assets/images/editar.png" style="width: 300px; height: auto;">
          </div>
           
              <p class="text-center mt-5">La tabla estará disponible una vez que hayas seleccionado los datos a mostrar.</p>
            
            
        </ng-template>
      </div>
    </div> <!-- cierre col-7 -->
  </div> <!--cierro row contenido-->

</div>
